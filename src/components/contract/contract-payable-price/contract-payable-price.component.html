<edit-contract-navigation
    *ngIf="contractId"
    [contractId]= "contractId"
    [isInPayablePriceSection]= "true"
    [hasProjectItem]="contract && contract.projectItem !=undefined"
    [hasPayablePrice]="payablePrice!=undefined && payablePrice!=0"
></edit-contract-navigation>

<loading
    *ngIf="isLoading"
></loading>

<section
    *ngIf="!isLoading && contract"
    class="message"
>
    <dl>
        <dt>
            مساحت ثبت شده
        </dt>
        <dd>
            {{contract.projectItem.area || contract.projectItem.buildupArea}}
        </dd>

        <dt>
            قیمت هر متر
        </dt>
        <dd>
            <price-label
                [price]="contract.projectItem.unitPrice"
            ></price-label>
        </dd>

        <dt>
            مجموع قیمت
        </dt>
        <dd>
            <price-label
                [price]="projectItemHelper.calculateTotalPrice(contract.projectItem)"
            ></price-label>
        </dd>

    </dl>
    <button
        (click)="setValueFromProjectItemDate()"
        class="secondary"
    >
        درج در مبلغ نهایی
    </button>
</section>

<form
    *ngIf="!isLoading && contract"
>
    <legend
        class="contract-legend"
    >
        بهای موضوع قرارداد
    </legend>

    <fieldset
        [disabled]="isLoading"
    >
        <ul>
            <li>
                <label
                    for="cmpDiscount"
                >
                    مبلغ تخفیف
                </label>

                <price-input
                    id = 'cmpDiscount'
                    name = 'cmpDiscount'
                    (setPrice)="setDiscount($event)"
                    [price]="discount"
                ></price-input>

            </li>
            <li>
                <label
                    for="cmpPayablePrice"
                >
                    مبلغ نهایی
                </label>

                <price-input
                    id = 'cmpPayablePrice'
                    name = 'cmpPayablePrice'
                    (setPrice)="setPayablePrice($event)"
                    [price]="payablePrice"
                ></price-input>
            </li>
        </ul>

        <loading
            *ngIf="isLoading"
        ></loading>

        <validation-result
            *ngIf="validationResult.hasError"
            [validationResult]="validationResult"
        ></validation-result>

        <ul>
            <li>
                <button
                    type="button"
                    (click)="save()"
                    class="primary"
                >
                    ثبت
                </button>
            </li>
        </ul>
    </fieldset>
</form>